<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurante Exemplo</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.15.6/dist/umd/supabase.min.js"></script>

    
</head>
<body>
    <!-- Cabeçalho Fixo -->
    <header>
        <div class="logo">
            <a href="#home">
                <img src="logo.png" alt="Logo do Restaurante Exemp lo">
            </a>
        </div>
        <nav>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#menu">Menu</a></li>
                <li><a href="#reservas">Reservas</a></li>
                <li><a href="#sobre-nos">Sobre-Nós</a></li>
                <li><a href="#contato">Contato</a></li>
            </ul>
        </nav>
    </header>

    <!-- Seção Home -->
    <section id="home">
        <div class="hero">
        </div>
    </section>

    <!-- Seção Menu -->
    <section id="menu">
        <div class="menu1">
            <a>
                <img src="menu1.png" alt="Menu">
            </a>
            <a>
                <img src="menu2.png" alt="Menu">
            </a>

        </div>

    </section>

    <!-- Seção Reservas -->
    <section id="reservas">
    <!-- Mapa das Mesas -->
    <div class="map-container">
        <h2 class="s">Escolha sua Mesa</h2>
        <div class="table-layout" id="table-layout">
            <div class="table" data-table-number="1">
                <img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100">
            </div>
            <div class="table" data-table-number="2"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="3"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="4"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="5"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>

            <div class="table" data-table-number="6"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="7"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="8"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="9"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="10"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="11"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="12"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="13"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="14"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="15"><img src="mesinha2.png" alt="mesinha2" alt="Icon" width="100" height="100"></div>
            <div class="table" data-table-number="16"></div>
            <div class="table" data-table-number="17"></div>

        </div>
    </div>

    <!-- Formulário de Reserva -->
    <div class="reservation-container">

        <div class="top-reserv"></div>       
        

        <h2>Detalhes da Reserva</h2>
        
        <div class="reservation-details">
            <div class="mesinha">
                <img src="mesinha.png" alt="mesinha" alt="Icon" width="150" height="150">
            </div> 
            <p id="selected-table">Nenhuma mesa selecionada</p>
            <div class="inputs">
                <input type="text" id="name" placeholder="Digite seu nome">
                <input type="number" id="people" placeholder="Digite a quantidade de pessoas">
                <input type="datetime-local" id="datetime">
            </div>
        </div>

        
    </div>

    <script>
        // Lista de mesas reservadas 
        const reservedTables = [3, 6, 10];

        // Seleção de elementos
        const tables = document.querySelectorAll('.table');
        const selectedTableElement = document.getElementById('selected-table');

        // Função para inicializar as mesas
        function initializeTables() {
            tables.forEach(table => {
                const tableNumber = parseInt(table.getAttribute('data-table-number'));

                // Define as mesas como reservadas (vermelho) conforme a lista
                if (reservedTables.includes(tableNumber)) {
                    table.classList.add('reserved');
                } else {
                    table.classList.add('available');
                    table.addEventListener('click', () => selectTable(table));
                }
            });
        }

        // Função para selecionar uma mesa
        function selectTable(selectedTable) {
            // Remover a seleção anterior
            tables.forEach(table => {
                if (table.classList.contains('selected')) {
                    table.classList.remove('selected');
                    table.classList.add('available');
                }
            });


            // Marcar a mesa selecionada como verde e atualizar o texto
            selectedTable.classList.remove('available');
            selectedTable.classList.add('selected');
            const tableNumber = selectedTable.getAttribute('data-table-number');
            selectedTableElement.textContent = `Mesa ${tableNumber} Selecionada`;
            // Alterar a imagem da mesa selecionada
            const image = selectedTable.querySelector('img');
            image.src = 'mesinha2-selected.png'; // Troque por uma imagem alternativa
        }

        // Inicializa as mesas ao carregar a página
        window.addEventListener('DOMContentLoaded', initializeTables);
    </script>
    </section>

    <script src="script.js"></script>



    
<!--CHAT BOT-->

<div class="chatbot">
    <div class="chatbot-icon-container">
        <img id="chatbot-icon" src="chat.png" alt="Chatbot Icon" width="150" height="150" style="display: none;">
    </div>
    <div class="chatbot-header">
        <img id="chatbot-iconH" src="chat.png" alt="Chatbot Icon" width="30" height="30">
        <h4>Assistente Virtual</h4>
        <button id="chatbot-toggle" class="toggle-btn">_</button>
    </div>
    <div class="chatbot-body">
        <div class="chatbot-messages" id="chatbot-messages">
            <!-- Mensagens irão aparecer aqui -->
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatbot-input" placeholder="Digite sua mensagem...">
            <button id="send-btn">Enviar</button>
        </div>
    </div>
</div>

<script>
    const chatbotToggle = document.getElementById('chatbot-toggle');
    const chatbotHeader = document.querySelector('.chatbot-header');
    const chatbotBody = document.querySelector('.chatbot-body');
    const chatbotFull = document.querySelector('.chatbot');
    const sendBtn = document.getElementById('send-btn');
    const inputField = document.getElementById('chatbot-input');
    const messagesContainer = document.getElementById('chatbot-messages');
    

    chatbotToggle.addEventListener('click', () => {
        chatbotHeader.classList.toggle('collapsed');
        chatbotBody.classList.toggle('collapsed');
        chatbotFull.classList.toggle('collapsed');
        chatbotToggle.textContent = chatbotBody.classList.contains('collapsed') ? '^' : '_';
        
    
        const chatbotIcon = document.getElementById('chatbot-icon');
        chatbotIcon.style.display = chatbotBody.classList.contains('collapsed') ? 'block' : 'none';
    });

    document.getElementById('chatbot-icon').addEventListener('click', () => {
        chatbotHeader.classList.remove('collapsed');
        chatbotBody.classList.remove('collapsed');
        chatbotFull.classList.remove('collapsed');
        chatbotToggle.textContent = '_';
        document.getElementById('chatbot-icon').style.display = 'none';
    });

    sendBtn.addEventListener('click', async () => {
        const userMessage = inputField.value.trim();
        if (userMessage) {
            addMessage(userMessage, 'user');
            inputField.value = '';


            //Lever isso de volta pro if
            //Cardápio: ${JSON.stringify(cardapio)}. Com base nisso,-> Parte do pronpt

            //----------------------------------------------------------------------------


            
            const cardapio = await loadMenu();
            if (cardapio) {
                let mensagemComCardapio = ` Cardápio: ${JSON.stringify(cardapio)}. Com base nisso,sugira algo para alguém que quer ${userMessage}.`;
                
    
            const reply = await getOpenAIRecommendation(mensagemComCardapio);
            addMessage(reply, 'bot');
                
            } else {
                addMessage('Desculpe, não consegui carregar o cardápio.', 'bot');
            }
        }
    });

    function addMessage(text, sender) {
        const messageDiv = document.createElement('div');
        messageDiv.classList.add('message', sender);
        messageDiv.textContent = text;
        messagesContainer.appendChild(messageDiv);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

 
    async function loadMenu() {
        const cardapioUrl = './Rejanes7/menu.json'; 
    try {
        console.log('Carregando cardápio de:', cardapioUrl);
        const response =  "Entradas: - Bruschetta Tradicional: Fatias de pão italiano, cobertas com tomate fresco, manjericão e azeite de oliva. Preço: R$ 25,00 - Carpaccio de Carne: Finas fatias de carne bovina, temperadas com limão, azeite e parmesão. Preço: R$ 38,00 - Caprese: Salada de tomate, muçarela de búfala, manjericão fresco e azeite balsâmico. Preço: R$ 32,00 Pratos Principais: - Spaghetti Alla Carbonara: Massa spaghetti com molho cremoso de ovos, queijo pecorino, pancetta e pimenta preta. Preço: R$ 58,00 - Tagliatelle Al Ragù: Massa tagliatelle com ragu de carne lentamente cozido em molho de tomate. Preço: R$ 60,00 - Risotto Ai Funghi: Risoto cremoso de arroz arbóreo com cogumelos frescos e queijo parmesão. Preço: R$ 72,00 Sobremesas: - Tiramisu: Camadas de biscoito savoiardi embebido em café, mascarpone e cacau. Preço: R$ 28,00 - Panna Cotta com Calda de Frutas Vermelhas: Sobremesa cremosa italiana servida com calda de frutas vermelhas frescas. Preço: R$ 26,00 - Cannoli Siciliani: Casquinha crocante recheada com creme de ricota doce e pedaços de chocolate. Preço: R$ 30,00 Bebidas: - Água Mineral: Preço: R$ 8,00 - Suco Natural: Preço: R$ 12,00 - Refrigerantes: Preço: R$ 10,00 - Vinho Tinto e Vinho Branco (Taças): Preço: R$ 28,00 - Vinho Tinto e Vinho Branco (Garrafas): Preço: R$ 120,00 - Limoncello: Preço: R$ 22,00";


        // const response = await fetch(cardapioUrl);
        // if (!response.ok) {
        //     throw new Error(`Erro ao carregar o cardápio: ${response.status} ${response.statusText}`);
        // }
        // const menu = await response.json();
        const menu = response
        console.log('Cardápio carregado:', menu); 
        return menu;
    } catch (error) {
        console.error('Erro ao carregar o cardápio:', error);
        return null;
    }
    } 

    
    async function getOpenAIRecommendation(message) {
        const apiKey = 'sk-WOOobpZtSyURgNo4rY1kJ6QYPF2SqzPkfH8bJI1oyQT3BlbkFJeKBOTR3mes9QLksPr3Q2AlmDtwhX9SxNvoyqBb5fgA';  // Insira sua API key da OpenAI aqui

        try {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo", 
                    messages: [{ role: "user", content: message }]
                })
            });

            if (!response.ok) {
                throw new Error(`Erro na API da OpenAI: ${response.status} ${response.statusText}`);
            }

            const data = await response.json();
            return data.choices[0].message.content; 
        } catch (error) {
            console.error('Erro ao obter recomendação da OpenAI:', error);
            return "Desculpe, houve um erro ao processar sua solicitação.";
        }
    }
</script>


</html>
